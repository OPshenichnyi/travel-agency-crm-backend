# Database Management Guide

## Поточна конфігурація

Цей проект використовує **SQLite** базу даних для локальної розробки. Файл бази даних знаходиться в кореневій папці: `database.sqlite`

## Проблема з перезаписом даних

**Проблема:** Раніше при кожному перезавантаженні сервера база даних повністю перезаписувалася, втрачаючи всі дані.

**Рішення:** Змінено логіку синхронізації моделей в `src/models/index.js`:

- **Раніше:** `force: true` при `NODE_ENV=development` (перезаписувало всі таблиці)
- **Тепер:** `alter: true` при `NODE_ENV=development` (зберігає дані, оновлює структуру)

## Команди для роботи з базою даних

### Звичайний запуск (зберігає дані)
```bash
npm run dev
# або
npm start
```

### Повне скидання бази даних (ВНИМАНИЕ: втратить всі дані!)
```bash
npm run reset-db
```

### Створення адміністратора
```bash
npm run reset-admin
```

### Скидання пароля користувача
```bash
npm run reset-password
```

## Змінні середовища

Створіть файл `.env` в кореневій папці з наступними налаштуваннями:

```env
# Environment settings
NODE_ENV=development

# Database settings
# FORCE_SYNC=true  # Розкоментуйте ТІЛЬКИ коли хочете повністю скинути базу

# Server settings
PORT=3000

# Email settings (якщо потрібно)
# SMTP_HOST=
# SMTP_PORT=
# SMTP_USER=
# SMTP_PASS=
```

## Docker (PostgreSQL)

Для використання PostgreSQL через Docker:

```bash
docker-compose up -d
```

**Увага:** Docker конфігурація використовує PostgreSQL, а не SQLite. Якщо ви хочете використовувати SQLite з Docker, потрібно змінити конфігурацію.

## Структура бази даних

Основні таблиці:
- `Users` - користувачі системи
- `Invitations` - запрошення
- `Orders` - замовлення
- `BankAccounts` - банківські рахунки

## Міграції

Для зміни структури бази даних використовуйте міграції в папці `src/migrations/`.

## Логування

Всі операції з базою даних логуються в консоль при `NODE_ENV=development`. 